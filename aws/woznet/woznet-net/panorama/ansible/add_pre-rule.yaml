# https://paloaltonetworks.github.io/pan-os-ansible/modules/panos_security_rule.html
---
- name: Add security-rule to Panorama. Ansible doesn't allow pre or post.
  panos_security_rule:
    provider: '{{ provider }}'
    rule_name: '{{ item.name }}'
    description: '{{ item.description }}'
    source_zone: '{{ item.source_zone }}'
    destination_zone: '{{ item.destination_zone }}'
    source_ip: '{{ item.source_ip }}'
    source_user: '{{ item.source_user }}'
    destination_ip: '{{ item.destination_ip }}'
    category: '{{ item.category }}'
    application: '{{ item.application }}'
    service: '{{ item.service }}'
    hip_profiles: '{{ item.hip_profiles }}'
    action: '{{ item.action }}'
    tag_name: '{{ item.tags }}' 
  register: add_pre_rule
  until: add_pre_rule is not failed
  retries: 3
  with_items:
    - { name: 'Palo Alto Blocks Inbound', description: 'Best practice blocks.', source_zone: ['any'], destination_zone: ['any'], source_ip: ['panw-bulletproof-ip-list', 'panw-highrisk-ip-list', 'panw-known-ip-list', 'panw-torexit-ip-list'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['any'], service: ['application-default'], hip_profiles: ['any'], action: 'allow', tags: ['Block', 'Inbound'] }
    - { name: 'Allow QA-WORKSPACES', description: 'Allow QA to access Workspaces (BSP-1958)', source_zone: ['any'], destination_zone: ['any'], source_ip: [DEV-QA], source_user: ['any'], destination_ip: [WORKSPACES], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Internal'] }
    - { name: 'Allow WORKSPACES-QA', description: 'Allow QA to access Workspaces (BSP-1958)', source_zone: ['any'], destination_zone: ['any'], source_ip: [WORKSPACES], source_user: ['any'], destination_ip: [DEV-QA], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Internal'] }
    - { name: 'Allow WORKSPACES-DEV', description: 'Allow WORKSPACES to access all of DEV', source_zone: ['any'], destination_zone: ['any'], source_ip: [WORKSPACES], source_user: ['any'], destination_ip: [DEV], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Internal'] } 
    - { name: 'Allow QA-OLDQA', description: 'Allow DEVQA to access old DEVQA (temporary)', source_zone: ['any'], destination_zone: ['any'], source_ip: [DEV-QA], source_user: ['any'], destination_ip: [OLD-DEVQA], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Internal'] }
    - { name: 'Allow UAT_AI-FTP', description: 'Allow UAT-AI to access FTP server', source_zone: ['any'], destination_zone: ['any'], source_ip: [UAT-AI], source_user: ['any'], destination_ip: [UAT-FTPS], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['External'] }
    - { name: 'Allow Mercedes egress', description: 'Allow Mercedes egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [Mercedes], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow GMF Dealer egress', description: 'Allow GMF Dealer egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [GMF], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] } 
    - { name: 'Allow India_Ai egress', description: 'Allow India_Ai_Access egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [India_Ai], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow BMW_MX egress', description: 'Allow BMW_MX egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [BMW_MX], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow Element_PNC egress', description: 'Allow Element_PNC egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [Element_PNC], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow ECF_SouthKorea egress', description: 'Allow ECF_SouthKorea egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [ECF_SouthKorea], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] } 
    - { name: 'Allow CMW_Australia egress', description: 'Allow CMW_Australia egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [CMW_Australia], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow JPM Chase egress', description: 'Allow JPM Chase egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [JPM_Chase], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow BOH_Guam egress', description: 'Allow BOH_Guam egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [BOH_Guam], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] } 
    - { name: 'Allow First_Hawaiian_Bank_Guam egress', description: 'Allow First_Hawaiian_Bank_Guam', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [First_Hawaiian_Bank_Guam], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow TCFIF egress', description: 'Allow TCFIF egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [TCFIF], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow MTB egress', description: 'Allow MTB egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [MTB], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] } 
    - { name: 'Allow Suntrust_BB_T egress', description: 'Allow Suntrust_BB_T egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [Suntrust_BB_T], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow BMO egress', description: 'Allow BMO egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [BMO], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow Mazda_Manheim egress', description: 'Allow Mazda_Manheim egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [Mazda_Manheim], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow PNC_SouthKoreaFTP egress', description: 'Allow PNC_SouthKoreaFTP egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [PNC_SouthKoreaFTP], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow Hyundai egress', description: 'Allow Hyundai egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [Hyundai], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] } 
    - { name: 'Allow VWC egress', description: 'Allow VWC egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [VWC], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow VPN-DEV', description: 'Allow VPN to DEV', source_zone: ['any'], destination_zone: ['any'], source_ip: [CVPN], source_user: ['any'], destination_ip: [DEV], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow Infrastructure Traffic', description: 'Allow Infrastructure Traffic', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['dns','ntp'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow DST Business Apps', description: 'Allow DST Business Apps', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['slack','ms-office365','jira','confluence','salesforce'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: ['Egress', 'External'] }
    - { name: 'Allow RDP', description: 'Allow RDP', source_zone: ['any'], destination_zone: ['any'], source_ip: [CVPN], source_user: ['any'], destination_ip: [DEV], category: ['any'], application: ['ms-rdp'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Allow google-base',   description: 'Allow Google Base',   source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['google-base'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Allow ms-update' ,    description: 'Allow MS Updates',    source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['ms-update'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Allow SSH',           description: 'Allow SSH',           source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['ssh', 'ssh-tunnel'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Allow stackoverflow', description: 'Allow Stackoverflow', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['stackoverflow'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Allow Web-Browsing', description: 'Allow Web-Browsing', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['web-browsing','ssl'], service: ['any'], hip_profiles: ['any'], action: 'allow', tags: [] }
    - { name: 'Geoblock', description: 'Deny traffic from geoblocked countries by egress', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['AF', 'AL', 'DZ', 'AD', 'AO', 'AQ', 'AR', 'AM', 'AT', 'AZ', 'BH', 'BD', 'BY', 'BE', 'BJ', 'BT', 'BO', 'BA', 'BW', 'BV', 'BR', 'BN', 'BG', 'BF', 'BI', 'KH', 'CM', 'CV', 'CF', 'TD', 'CL', 'CN', 'CX', 'CC', 'CO', 'KM', 'CG', 'CD', 'CK', 'HR', 'CI', 'CU', 'CW', 'CY', 'CZ', 'DK', 'DJ', 'EC', 'EG', 'GQ', 'ER', 'EE', 'ET', 'EU', 'FK', 'FO', 'FJ', 'FI', 'FR', 'GF', 'PF', 'GA', 'GM', 'GE', 'DE', 'GH', 'GI', 'GR', 'GG', 'GN', 'GW', 'GY', 'VA', 'HK', 'HU', 'IS', 'IN', 'ID', 'IR', 'IQ', 'IE', 'IM', 'IL', 'IT', 'JP', 'JE', 'JO', 'KZ', 'KE', 'KI', 'KP', 'KR', 'KW', 'KG', 'AX', 'LA', 'LV', 'LB', 'LS', 'LR', 'LY', 'LI', 'LT', 'LU', 'MO', 'MK', 'MG', 'MW', 'MY', 'MV', 'ML', 'MT', 'MH', 'MR', 'MU', 'YT', 'FM', 'MD', 'MC', 'MN', 'ME', 'MA', 'MZ', 'MM', 'NA', 'NR', 'NP', 'NL', 'NC', 'NE', 'NG', 'NU', 'NF', 'MP', 'NO', 'OM', 'PK', 'PW', 'PS', 'PG', 'PY', 'PE', 'PH', 'PN', 'PL', 'PT', 'QA', 'RO', 'RE', 'RU', 'RW', 'SH', 'WS', 'SM', 'ST', 'SA', 'SN', 'RS', 'SC', 'SL', 'SG', 'SX', 'SK', 'SI', 'SB', 'SO', 'ZA', 'GS', 'SS', 'ES', 'LK', 'SD', 'SR', 'SJ', 'SZ', 'SE', 'CH', 'SY', 'TW', 'TJ', 'TZ', 'TH', 'TL', 'TG', 'TK', 'TO', 'TN', 'TR', 'TM', 'TV', 'UG', 'UA', 'AE', 'GB', 'UY', 'UZ', 'VU', 'VE', 'VN', 'WF', 'EH', 'YE', 'ZM', 'ZW' ], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Allow_Monitoring', description: 'Allow everything to access Monitoring endpoints', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: [MONITORING], category: ['any'], application: ['any'], service: [Monitoring-Services], hip_profiles: ['any'], action: 'allow', tags: ['Internal'] }
    - { name: 'Deny QA-UAT',  description: 'Deny traffic between QA to UAT',  source_zone: ['any'], destination_zone: ['any'], source_ip: [DEV-QA], source_user: ['any'], destination_ip: [UAT],    category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny UAT-QA',  description: 'Deny traffic between QA to UAT',  source_zone: ['any'], destination_zone: ['any'], source_ip: [UAT],    source_user: ['any'], destination_ip: [DEV-QA], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny QA-PROD', description: 'Deny traffic between QA to PROD', source_zone: ['any'], destination_zone: ['any'], source_ip: [DEV-QA], source_user: ['any'], destination_ip: [PROD],   category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny PROD-QA', description: 'Deny traffic between QA to PROD', source_zone: ['any'], destination_zone: ['any'], source_ip: [PROD],   source_user: ['any'], destination_ip: [DEV-QA], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny VPN-UAT', description: 'Deny traffic between VPN and UAT', source_zone: ['any'], destination_zone: ['any'], source_ip: [CVPN],   source_user: ['any'], destination_ip: [UAT], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny UAT-AI-UAT-WI', description: 'Deny traffic between UAT-AI - UAT-WI', source_zone: ['any'], destination_zone: ['any'], source_ip: [UAT-AI],   source_user: ['any'], destination_ip: [UAT-WI], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny UAT-WI-UAT-AI', description: 'Deny traffic between UAT-WI - UAT-AI', source_zone: ['any'], destination_zone: ['any'], source_ip: [UAT-WI],   source_user: ['any'], destination_ip: [UAT-AI], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny VPN-PROD', description: 'Deny traffic between VPN and PROD', source_zone: ['any'], destination_zone: ['any'], source_ip: [CVPN],   source_user: ['any'], destination_ip: [PROD], category: ['any'], application: ['any'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny Audio_Streaming', description: 'Deny Audio_Streaming', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['audio_streaming'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny Gaming', description: 'Deny Gaming', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['gaming'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    - { name: 'Deny Social Media', description: 'Deny Social Media', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['social_networking'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    #- { name: 'Deny High Risk4 Applications', description: 'Deny High Risk4 Applications', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['high_risk_applications_4'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
    #- { name: 'Deny High Risk5 Applications', description: 'Deny High Risk5 Applications', source_zone: ['any'], destination_zone: ['any'], source_ip: ['any'], source_user: ['any'], destination_ip: ['any'], category: ['any'], application: ['high_risk_applications_5'], service: ['any'], hip_profiles: ['any'], action: 'deny', tags: ['Block'] }
