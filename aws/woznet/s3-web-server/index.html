<!DOCTYPE html>
<html>

<head>
  <title>Datascan Connectivity Test</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <META content=noindex,nofollow,noarchive name=robots>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="assets/bootstrap/css/bootstrap.css" rel="stylesheet">
  <link href="assets/lightbox/css/lightbox.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/style.css">
</head>

<body>

  <div class="container">
    <div id="formContent" class="mt-3 mt-lg-5 mb-3 mb-lg-5 ">

      <!-- Icon -->
      <div class="first">
        <img src="assets/logo.png" id="logo" />
        <h3 id="title" style="margin-top: 15px">Connectivity Test Page</h3>
        <h5>You are connected from IP Address: <span id="ipAddress" style="margin-top: 20px; margin-bottom: 20px;"></span></h5>
      </div>
      <div id="container" style="width:80%; margin: 0 auto;">
        <div class="section-status">
          <div class="alert alert-warning">
            To ensure FTP is functioning, please have your File Transmission Team execute a Telnet test.
            <br />
            <button type="button" class="btn btn-primary btn-sm pulse" data-toggle="modal" data-target="#telnetInstructionsModal">Telnet Test Instructions</button>
          </div>
        </div>
        <ul class="nav nav-tabs" id="testTab" role="tablist" style="margin-top: 25px">
          <li class="nav-item">
            <a class="nav-link active" id="start-tab" data-toggle="tab" href="#start-datacenter" role="tab" aria-controls="start-datacenter" aria-selected="true">Start</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="ne-tab" data-toggle="tab" href="#ne-datacenter" role="tab" aria-controls="ne-datacenter" aria-selected="false">NorthEast Datacenter</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="se-tab" data-toggle="tab" href="#se-datacenter" role="tab" aria-controls="se-datacenter" aria-selected="false">SouthEast Datacenter</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="mr-cloud-tab" data-toggle="tab" href="#mr-cloud" role="tab" aria-controls="se-datacenter" aria-selected="false">Cloud</a>
          </li>
        </ul>
        <div class="tab-content" id="testTabContent">
          <div class="tab-pane active" id="start-datacenter" role="tabpanel" aria-labelledby="start-tab" style="text-align: left; border: 1px solid #dee2e6; margin-bottom: 20px; padding: 10px; padding-top:20px">
            <p style="text-align:center; color: red; font-size: .8rem;">This connectivtiy test tool is supported with the following browser: Chrome, Edge, Firefox.</p>
            <h3 style="text-align:center">Overview</h3>
            <p style="text-align:center">This website is used to test your connectivity to the Datascan Service Endpoints.</p>
            <h5 style="text-align:center">Test Status Key</h5>
            <table class="table" style="width:25%; margin:0 auto;">
              <tr>
                <td>Success</td>
                <td><img class="connection-indicator connection-success key"></img></td>
              </tr>
              <tr>
                <td>Failure</td>
                <td><img class="connection-indicator connection-error key"></img></td>
              </tr>
              <tr>
                <td>Running</td>
                <td><img class="connection-indicator connection-loading key"></img></td>
              </tr>
            </table>
            <div class="row">
              <div class="col-12" style="padding-left:65px; padding-right:65px">
                <h4>How do I use it?</h4>
                <p>To test connectivity to the Datascan Service Endpoints, click on the tabs above. Once clicked, each tab will initiate a series of automated tests, testing connectivity to various Service Endpoints located in the selected zone.</p>
                <h4>How do I know if it was successful?</h4>
                <p>If your browser successfully connected to the datacenter you will see a green check mark as shown above.</p>
                <h4>I received a red X. What should I do?</h4>
                <p>If you received a red X on any of the tests, please contact your internal IT/Network department, who will then contact DataScan Support.</p>
                <p style="font-style: italic">
                  * This tool does not perform service availability test. It only performs a connectivity test; whether your current system reach our endpoints.
                </p>
              </div>

            </div>
          </div>
          <div class="tab-pane" id="ne-datacenter" role="tabpanel" aria-labelledby="ne-tab" style="text-align: left">
            <ul class="list-group bottom-margin">
              <li class="dropdown list-group-item list-group-item-info"><imgclass="fa fa-caret-down"></img> Production Platform</li>
              <li class="list-group-item">
                <p class="indent">API</p>
                <img data-testurl="https://ne-prod-api.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">Wi</p>
                <img data-testurl="https://ne-prod-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">Ai</p>
                <img data-testurl="https://ne-prod-ai.ai.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">DAS</p>
                <img data-testurl="https://ne-prod-das.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">SSO</p>
                <img data-testurl="https://ne-prod-sso.sso.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">Citrix</p>
                <img data-testurl="https://ne-prod-ctx.wi.onedatascan.com/vpn/index.html?datascan-network-test=1" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">DAS</p>
                <img data-testurl="https://ne-prod.dealeraccesssystem.com/datascan-network-test" class="connection-indicator"></img>
              </li>
            </ul>

          </div>
          <div class="tab-pane" id="se-datacenter" role="tabpanel" aria-labelledby="se-tab">
            <ul class="list-group bottom-margin">
              <ul class="list-group">
                <li class="dropdown list-group-item list-group-item-info"><imgclass="fa fa-caret-down"></img> Production Platform</li>
                <li class="list-group-item">
                  <p class="indent">API</p>
                  <img data-testurl="https://se-prod-api.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Wi</p>
                  <img data-testurl="https://se-prod-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Ai</p>
                  <img data-testurl="https://se-prod-ai.ai.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">DAS</p>
                  <img data-testurl="https://se-prod-das.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">SSO</p>
                  <img data-testurl="https://se-prod-sso.sso.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Citrix</p>
                  <img data-testurl="https://se-prod-ctx.wi.onedatascan.com/vpn/index.html?datascan-network-test=1" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">DAS</p>
                  <img data-testurl="https://se-prod.dealeraccesssystem.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="dropdown list-group-item list-group-item-info"><imgclass="fa fa-caret-down"></img> UAT Platform</li>
                <li class="list-group-item">
                  <p class="indent">API</p>
                  <img data-testurl="https://se-uat-api.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Wi</p>
                  <img data-testurl="https://se-uat-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Ai</p>
                  <img data-testurl="https://se-uat-ai.ai.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">DAS</p>
                  <img data-testurl="https://se-uat-das.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">SSO</p>
                  <img data-testurl="https://se-uat-sso.sso.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">Citrix</p>
                  <img data-testurl="https://se-uat-ctx.wi.onedatascan.com/vpn/index.html?datascan-network-test=1" class="connection-indicator"></img>
                </li>
                <li class="list-group-item">
                  <p class="indent">DAS</p>
                  <img data-testurl="https://se-uat.dealeraccesssystem.com/datascan-network-test" class="connection-indicator"></img>
                </li>
              </ul>
          </div>
          <div class="tab-pane" id="mr-cloud" role="tabpanel" aria-labelledby="mr-cloud-tab" style="text-align: left">
            <ul class="list-group bottom-margin">
              <li class="dropdown list-group-item list-group-item-info"><imgclass="fa fa-caret-down"></img> Prod Platform</li>
              <li class="list-group-item">
                <p class="indent">Ai</p>
                <img data-testurl="https://www-ai.ai.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">Wi</p>
                <img data-testurl="https://www-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">DAS</p>
                <img data-testurl="https://www-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">SSO</p>
                <img data-testurl="https://www-sso.sso.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">API</p>
                <img data-testurl="https://www-ws.ws.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="dropdown list-group-item list-group-item-info"><imgclass="fa fa-caret-down"></img> UAT Platform</li>
              <li class="list-group-item">
                <p class="indent">Ai</p>
                <img data-testurl="https://uat-ai.ai.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">Wi</p>
                <img data-testurl="https://uat-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">DAS</p>
                <img data-testurl="https://uat-wi.wi.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">SSO</p>
                <img data-testurl="https://uat.sso.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
              <li class="list-group-item">
                <p class="indent">API</p>
                <img data-testurl="https://uat.ws.onedatascan.com/datascan-network-test" class="connection-indicator"></img>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="modal fade" tabindex="-1" role="dialog" id="telnetInstructionsModal">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Telnet Test Instructions</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="text-align: left;">
              <p class="text-center">FTP Server IPs</p>
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">NE Production IP</th>
                    <th scope="col">SE Production IP</th>
                    <th scope="col">SE UAT IP</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>149.97.129.38</td>
                    <td>149.97.133.6</td>
                    <td>149.97.133.22</td>
                  </tr>
                </tbody>
              </table>
              <hr style="border-top: dashed 1px;" />

              <h5 class="text-center mt-sm-3 mb-sm-3">To test your FTP connection using the command line, follow these steps.</h5>
              <ol>
                <li>Open a command line interface:
                  <ul>
                    <li>In Windows, click Start, then Run. In the Run dialog box type cmd and click OK.</li>
                    <li>In MacOSX open a Terminal window.</li>
                  </ul>
                </li>

                <li>At the command prompt type 'telnet', the ftp server ip, '21' and hit Enter
                  <ul>
                    <li>Example: <b>telnet 149.97.133.22 21</b></li>
                  </ul>
                </li>
                <li>On a successful connection you should see the message <b>"Welcome to the DataScan FTP/FTPS server"</b></li>


                  <img style="width: 90%; margin-top: 10px !important" class="rounded mx-auto d-block" src="assets/telnet.png" alt="Telnet Image">

                </a>

              </ol>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Remind Passowrd -->
      <div id="formFooter">
        <p>For support, please contact our Support Team at <br />1-800-877-7226.</p>
      </div>

    </div>
  </div>
  <script type="text/javascript" src="assets/jquery-1.12.4.js"></script>
  <script type="text/javascript" src="assets/lightbox/js/lightbox.js"></script>
  <script type="text/javascript" src="assets/bootstrap/js/bootstrap.js"></script>
  <script type="text/javascript" src="assets/images.js"></script>
  <script>
    if (!Date.now) {
      Date.now = function() {
        return new Date().getTime();
      }
    }

    if (!String.prototype.includes) {
      String.prototype.includes = function(search, start) {
        'use strict';

        if (search instanceof RegExp) {
          throw TypeError('first argument must not be a RegExp');
        }
        if (start === undefined) { start = 0; }
        return this.indexOf(search, start) !== -1;
      };
    }

    var timeouts = [];

    function performTests() {
      $(".connection-indicator").not(".key").each(function(index) {
        var $this = $(this);

        $this.attr("src", image_spinner);
        $this.addClass("connection-loading")

        timeouts.push(setTimeout(function() {
          $.ajax({
            type: "GET",
            url: $this.data('testurl'),
            data: Date.now(),
            cache: false,
            success: function(data, textStatus, xhr) {
              if(data.toLowerCase().includes('datascan')){
                $this.removeClass("connection-loading")
                $this.addClass("connection-success")
                $this.attr("src", image_check)
                $this.parent().hide().show(0);
              }
            },
            error: function( xhr) {
              console.log( xhr) 
            }
          });
        }, 2500));


        timeouts.push(setTimeout(function() {
          $this.removeClass("connection-loading")
          if (!$this.hasClass('connection-success')) {
            $this.addClass('connection-error').attr("src", image_times)
            $this.parent().hide().show(0);
          }
        }, 6000));
      });
    }

    function testsReset() {
      for (var i = 0; i < timeouts.length; i++) {
        clearTimeout(timeouts[i]);
      }
      timeouts = []
      $(".connection-indicator").not(".key").each(function(index) {
        $(this).removeClass()
          .addClass("connection-indicator")
      })
    }

    $(document).ready(function() {
      $(".connection-indicator.connection-success.key").attr("src", image_check);
      $(".connection-indicator.connection-error.key").attr("src", image_times);
      $(".connection-indicator.connection-loading.key").attr("src", image_spinner);

      //performTests();

      $('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
        testsReset()
        performTests();
      });

      $(".dropdown").click(function() {
        var collapsed = $(this).hasClass('collapsed')

        if (collapsed) {
          $(this).removeClass('collapsed')
          $(this).nextUntil('.list-group-item-info').slideDown();
        } else {
          $(this).addClass('collapsed')
          $(this).nextUntil('.list-group-item-info').slideUp();
        }

      })

      $.get("/myip", function(data) {
        $("#ipAddress").text(data.ip)
      });

    })
  </script>
</body>

</html>
